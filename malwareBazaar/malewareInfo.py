from malwareBazaar.MalwareBazaarAPI import MalwareBazaarAPI
from malwareBazaar.MalwareDataHandler import MalwareDataHandler
from malwareBazaar.writer.CSVWriter import CSVWriter


def main() -> None:
    print("Malware Info")

    # Instantiate the API and CSV writer
    api: MalwareBazaarAPI = MalwareBazaarAPI()
    writer: CSVWriter = CSVWriter("tags")

    # Instantiate the data handler
    handler: MalwareDataHandler = MalwareDataHandler(api, writer)

    # Define a limit for the number of samples to save
    save_limit = 20  # Limit for saved samples

    # Query for tags with a sample limit
    # --> Backdoor, Botnet, Adware
    # --> Trojan', 'Ransomware', 'Worm', 'Backdoor', 'Spyware', 'Rootkit', 'Encrypter', 'Downloader --> DikeDataset
    # "virus", "xworm", "trojan", "rootkit", "ransomware", "vipkeylogger", "snakekeylogger", "spyware", "formbook"
    tag_list: list[str] = ["trojan", "ransomware", "spyware"]
    for tag in tag_list:
        handler.query_tag(tag, limit=400, save_limit=save_limit)

    # Query for signatures
    signature_list: list[str] = [""]
    writer_signatures: CSVWriter = CSVWriter("signatures")
    signature_handler: MalwareDataHandler = MalwareDataHandler(api, writer_signatures)

    for signature in signature_list:
        signature_handler.query_signature(signature, limit=400, save_limit=save_limit)


if __name__ == "__main__":
    main()
