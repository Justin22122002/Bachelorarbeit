from malwareBazaar.MalwareBazaarAPI import MalwareBazaarAPI
from malwareBazaar.reader.CSVReader import CSVReader
from malwareBazaar.MalwareDownloader import MalwareDownloader


def main() -> None:
    """
    Main function to initiate the Malware Fetcher.
    """
    print("Malware Fetcher")

    # Base location where files will be stored
    location: str = "E:\First_Test_Run\malware"
    # API URL for querying malware samples
    url: str = "https://mb-api.abuse.ch/api/v1/"

    folder: str = "tags"  # Specify the folder where your CSV files are stored

    # Instantiate the CSVLoader and FileDownloader
    csv_loader: CSVReader = CSVReader(folder)
    file_downloader: MalwareBazaarAPI = MalwareBazaarAPI(url)

    # Create the MalwareFetcher and start fetching the samples
    fetcher: MalwareDownloader = MalwareDownloader(csv_loader, file_downloader, location)
    fetcher.fetch_samples()


if __name__ == "__main__":
    main()
