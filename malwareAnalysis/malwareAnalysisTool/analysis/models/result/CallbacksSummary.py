from dataclasses import dataclass
from typing import override

from malwareAnalysis.malwareAnalysisTool.analysis.models.result.Summary import Summary


@dataclass
class CallbacksSummary(Summary):
    """
    A data class to store summarized callback scan metrics.
    """
    callbacks_ncallbacks: int
    callbacks_nanonymous: int
    callbacks_ngeneric: int

    @override
    def create_csv_header(self) -> list[str]:
        """
        Generate a CSV header for the summary.
        """
        return [
            "callbacks_ncallbacks",
            "callbacks_nanonymous",
            "callbacks_ngeneric"
        ]

    @override
    def create_csv_summary(self) -> list[int | float]:
        """
        Generate a CSV summary row with the values.
        """
        return [
            self.callbacks_ncallbacks,
            self.callbacks_nanonymous,
            self.callbacks_ngeneric
        ]

    def __str__(self) -> str:
        """
        Generate a formatted string representation of the summary.
        """
        return (f"Callbacks Summary:\n"
                f"  Total Callbacks: {self.callbacks_ncallbacks}\n"
                f"  Anonymous Callbacks: {self.callbacks_nanonymous}\n"
                f"  Generic Callbacks: {self.callbacks_ngeneric}\n")
