from dataclasses import dataclass
from typing_extensions import override

from malwareAnalysis.malwareAnalysisTool.analysis.models.result.Summary import Summary


@dataclass
class SvcScanSummary(Summary):
    """
    A data class to store summarized service scan metrics.

    Attributes:
        svcscan_nservices (int): Total number of services.
        svcscan_kernel_drivers (int): Number of kernel drivers.
        svcscan_fs_drivers (int): Number of file system drivers.
        svcscan_process_services (int): Number of process services.
        svcscan_shared_process_services (int): Number of shared process services.
        svcscan_interactive_process_services (int): Number of interactive process services.
        svcscan_nactive (int): Number of active services.
    """

    svcscan_nservices: int
    svcscan_kernel_drivers: int
    svcscan_fs_drivers: int
    svcscan_process_services: int
    svcscan_shared_process_services: int
    svcscan_interactive_process_services: int
    svcscan_nactive: int

    @override
    def create_csv_header(self) -> list[str]:
        """
        Generate a CSV header for the summary.
        """
        return [
            "svcscan_nservices",
            "svcscan_kernel_drivers",
            "svcscan_fs_drivers",
            "svcscan_process_services",
            "svcscan_shared_process_services",
            "svcscan_interactive_process_services",
            "svcscan_nactive"
        ]

    @override
    def create_csv_summary(self) -> list[int]:
        """
        Generate a CSV summary row with the values.
        """
        return [
            self.svcscan_nservices,
            self.svcscan_kernel_drivers,
            self.svcscan_fs_drivers,
            self.svcscan_process_services,
            self.svcscan_shared_process_services,
            self.svcscan_interactive_process_services,
            self.svcscan_nactive
        ]

    def __str__(self) -> str:
        """
        Generate a formatted string representation of the summary.
        """
        return (f"Service Scan Summary:\n"
                f"  Total Services: {self.svcscan_nservices}\n"
                f"  Kernel Drivers: {self.svcscan_kernel_drivers}\n"
                f"  File System Drivers: {self.svcscan_fs_drivers}\n"
                f"  Process Services: {self.svcscan_process_services}\n"
                f"  Shared Process Services: {self.svcscan_shared_process_services}\n"
                f"  Interactive Process Services: {self.svcscan_interactive_process_services}\n"
                f"  Active Services: {self.svcscan_nactive}\n")