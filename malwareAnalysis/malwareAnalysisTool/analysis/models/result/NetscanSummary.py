from dataclasses import dataclass
from typing_extensions import override
from malwareAnalysis.malwareAnalysisTool.analysis.models.result.Summary import Summary


@dataclass
class NetscanSummary(Summary):
    """
    A data class to store summarized network metrics from a network scan.

    Attributes:
        nConn (int): Total number of connections.
        nDistinctForeignAdd (int): Number of distinct foreign addresses.
        nDistinctForeignPort (int): Number of distinct foreign ports.
        nDistinctLocalAddr (int): Number of distinct local addresses.
        nDistinctLocalPort (int): Number of distinct local ports.
        nOwners (int): Number of distinct process owners.
        nDistinctProc (int): Number of distinct processes.
        nListening (int): Number of listening connections.
        Proto_TCPv4 (int): Number of TCPv4 connections.
        Proto_TCPv6 (int): Number of TCPv6 connections.
        Proto_UDPv4 (int): Number of UDPv4 connections.
        Proto_UDPv6 (int): Number of UDPv6 connections.
    """

    nConn: int
    nDistinctForeignAdd: int
    nDistinctForeignPort: int
    nDistinctLocalAddr: int
    nDistinctLocalPort: int
    nOwners: int
    nDistinctProc: int
    nListening: int
    Proto_TCPv4: int
    Proto_TCPv6: int
    Proto_UDPv4: int
    Proto_UDPv6: int

    @override
    def create_csv_summary(self) -> list[int]:
        """
        Create a CSV-compatible summary as a list of values.
        """
        return [
            self.nConn,
            self.nDistinctForeignAdd,
            self.nDistinctForeignPort,
            self.nDistinctLocalAddr,
            self.nDistinctLocalPort,
            self.nOwners,
            self.nDistinctProc,
            self.nListening,
            self.Proto_TCPv4,
            self.Proto_TCPv6,
            self.Proto_UDPv4,
            self.Proto_UDPv6
        ]

    @override
    def create_csv_header(self) -> list[str]:
        """
        Return a CSV-compatible header.
        """
        return [
            "nConn",
            "nDistinctForeignAdd",
            "nDistinctForeignPort",
            "nDistinctLocalAddr",
            "nDistinctLocalPort",
            "nOwners",
            "nDistinctProc",
            "nListening",
            "Proto_TCPv4",
            "Proto_TCPv6",
            "Proto_UDPv4",
            "Proto_UDPv6"
        ]

    def __str__(self) -> str:
        """
        Provide a readable string representation of the summary.
        """
        return (f"Network Scan Summary:\n"
                f"  Total Connections: {self.nConn}\n"
                f"  Distinct Foreign Addresses: {self.nDistinctForeignAdd}\n"
                f"  Distinct Foreign Ports: {self.nDistinctForeignPort}\n"
                f"  Distinct Local Addresses: {self.nDistinctLocalAddr}\n"
                f"  Distinct Local Ports: {self.nDistinctLocalPort}\n"
                f"  Owners: {self.nOwners}\n"
                f"  Distinct Processes: {self.nDistinctProc}\n"
                f"  Listening Connections: {self.nListening}\n"
                f"  TCPv4 Connections: {self.Proto_TCPv4}\n"
                f"  TCPv6 Connections: {self.Proto_TCPv6}\n"
                f"  UDPv4 Connections: {self.Proto_UDPv4}\n"
                f"  UDPv6 Connections: {self.Proto_UDPv6}")
