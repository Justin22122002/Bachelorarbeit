from dataclasses import dataclass
from typing_extensions import override
from malwareAnalysis.malwareAnalysisTool.analysis.models.result.Summary import Summary


@dataclass
class ModulesSummary(Summary):
    """
    A data class to store summarized modules metrics.

    Attributes:
        modules_nmodules (int): Total number of modules.
    """

    modules_nmodules: int

    @override
    def create_csv_header(self) -> list[str]:
        """
        Returns the CSV header for the module summary data.
        """
        return ["modules_nmodules"]

    @override
    def create_csv_summary(self) -> list[int]:
        """
        Returns a list containing the summary data in a format suitable for CSV export.
        """
        return [self.modules_nmodules]

    def __str__(self) -> str:
        """
        Returns a string representation of the modules summary.
        """
        return f"Modules Summary:\n  Total Modules: {self.modules_nmodules}"
