from dataclasses import dataclass
from malwareAnalysis.malwareAnalysisTool.analysis.models.result.Summary import Summary

@dataclass
class FileChangeSummary(Summary):
    """
    Represents the summary statistics for file changes during analysis.

    Attributes:
        total_changes (int): Total number of changes made to files.
        added_files (int): Total number of files added.
        modified_files (int): Total number of files modified.
        deleted_files (int): Total number of files deleted.

    Interpretation of Metrics:
        - A high number of changes can indicate suspicious behavior.
        - Tracking added, modified, and deleted files provides insight into how the filesystem
          is being altered, which may signal malware activity.
    """

    total_changes: int
    added_files: int
    modified_files: int
    deleted_files: int

    def create_csv_summary(self) -> list[int]:
        """
        Returns a summary of the file change statistics as a list of values suitable for CSV output.
        """
        return [
            self.total_changes,
            self.added_files,
            self.modified_files,
            self.deleted_files
        ]

    def create_csv_header(self) -> list[str]:
        """
        Returns the CSV header corresponding to the file change statistics.
        """
        return [
            "file_total_changes",
            "file_added_files",
            "file_modified_files",
            "file_deleted_files"
        ]

    def __str__(self) -> str:
        """
        Returns a string representation of the file change summary.
        """
        return (f"File Change Summary:\n"
                f"  Total Changes: {self.total_changes}\n"
                f"  Files Added: {self.added_files}\n"
                f"  Files Modified: {self.modified_files}\n"
                f"  Files Deleted: {self.deleted_files}\n")