from dataclasses import dataclass

from malwareAnalysis.malwareAnalysisTool.analysis.models.result.Summary import Summary


@dataclass
class RegistryChangeSummary(Summary):
    total_changes: int
    added: int
    modified: int
    deleted: int

    def create_csv_summary(self) -> list[int | float]:
        return [
            self.total_changes,
            self.added,
            self.modified,
            self.deleted
        ]

    def create_csv_header(self) -> list[str]:
        return [
            "registry_total_changes",
            "registry_added_files",
            "registry_modified_files",
            "registry_deleted_files"
        ]

    def __str__(self) -> str:
        return (f"Registry Change Summary:\n"
                f"  Total Changes: {self.total_changes}\n"
                f"  Added: {self.added}\n"
                f"  Modified: {self.modified}\n"
                f"  Deleted: {self.deleted}\n")